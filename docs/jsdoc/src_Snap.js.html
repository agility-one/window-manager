<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>simple-window-manager API Documentation</title>
    
    <meta name="description" content="Documentation for simple-window-manager library" />
    
        <meta name="keywords" content="docs, documentation, html5, javascript, jsdoc, window manager" />
        <meta name="keyword" content="docs, documentation, html5, javascript, jsdoc, window manager" />
    
    
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://fonts.googleapis.com/css?family=Libre+Franklin:400,700" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/main.css">

    
    <script>
    var config = {"monospaceLinks":false,"cleverLinks":false,"default":{"outputSourceFiles":true},"applicationName":"simple-window-manager","footer":"by David Figatner (david@yopeyopey.com)","copyright":"Copyright Â© 2020 YOPEY YOPEY LLC.","meta":{"title":"simple-window-manager API Documentation","description":"Documentation for simple-window-manager library","keyword":"docs, documentation, html5, javascript, jsdoc, window manager"}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">simple-window-manager</a></h3>
    <button id="menuToggle" class="btn btn-link btn-lg menu-toggle">
        <span class="glyphicon glyphicon-menu-hamburger"></span>
    </button>
    <div class="search">
        <input id="search" type="text" class="form-control input-md" placeholder="Search...">
    </div>
    <ul class="list">
    
        
        <li class="item" data-name="Accelerator">
            <span class="title  ">
                
                <a href="Accelerator.html">Accelerator</a>
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            <span class="subtitle">Typedefs</span>
            
                <li class="parent" data-name="Accelerator~KeyCodes"><a href="Accelerator.html#~KeyCodes">KeyCodes</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li class="parent  " data-name="Accelerator#clearKeys"><a href="Accelerator.html#clearKeys">clearKeys</a></li>
            
                <li class="parent  " data-name="Accelerator#clearMenuKeys"><a href="Accelerator.html#clearMenuKeys">clearMenuKeys</a></li>
            
                <li class="parent  " data-name="Accelerator#prettifyKey"><a href="Accelerator.html#prettifyKey">prettifyKey</a></li>
            
                <li class="parent  " data-name="Accelerator#register"><a href="Accelerator.html#register">register</a></li>
            
                <li class="parent  " data-name="Accelerator#registerAlt"><a href="Accelerator.html#registerAlt">registerAlt</a></li>
            
                <li class="parent  " data-name="Accelerator#registerMenuShortcut"><a href="Accelerator.html#registerMenuShortcut">registerMenuShortcut</a></li>
            
                <li class="parent  " data-name="Accelerator#registerMenuSpecial"><a href="Accelerator.html#registerMenuSpecial">registerMenuSpecial</a></li>
            
                <li class="parent  " data-name="Accelerator#unregisterMenuShortcuts"><a href="Accelerator.html#unregisterMenuShortcuts">unregisterMenuShortcuts</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        
    
        
        <li class="item" data-name="Menu">
            <span class="title  ">
                
                <a href="Menu.html">Menu</a>
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li class="parent " data-name="Menu.config"><a href="Menu.html#.config">config</a></li>
            
                <li class="parent " data-name="Menu#items"><a href="Menu.html#items">items</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li class="parent  " data-name="Menu.getApplicationHeight"><a href="Menu.html#.getApplicationHeight">getApplicationHeight</a></li>
            
                <li class="parent  " data-name="Menu.setApplicationMenu"><a href="Menu.html#.setApplicationMenu">setApplicationMenu</a></li>
            
                <li class="parent  " data-name="Menu#append"><a href="Menu.html#append">append</a></li>
            
                <li class="parent  " data-name="Menu#insert"><a href="Menu.html#insert">insert</a></li>
            
                <li class="parent  " data-name="Menu#move"><a href="Menu.html#move">move</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        
        <li class="item" data-name="MenuItem">
            <span class="title  ">
                
                <a href="MenuItem.html">MenuItem</a>
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            <span class="subtitle">Typedefs</span>
            
                <li class="parent" data-name="MenuItem~ClickCallback"><a href="MenuItem.html#~ClickCallback">ClickCallback</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        
        <li class="item" data-name="Window">
            <span class="title  ">
                
                <a href="Window.html">Window</a>
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li class="parent " data-name="Window#bottom"><a href="Window.html#bottom">bottom</a></li>
            
                <li class="parent " data-name="Window#closed"><a href="Window.html#closed">closed</a></li>
            
                <li class="parent " data-name="Window#content"><a href="Window.html#content">content</a></li>
            
                <li class="parent " data-name="Window#height"><a href="Window.html#height">height</a></li>
            
                <li class="parent " data-name="Window#right"><a href="Window.html#right">right</a></li>
            
                <li class="parent " data-name="Window#title"><a href="Window.html#title">title</a></li>
            
                <li class="parent " data-name="Window#width"><a href="Window.html#width">width</a></li>
            
                <li class="parent " data-name="Window#win"><a href="Window.html#win">win</a></li>
            
                <li class="parent " data-name="Window#winBox"><a href="Window.html#winBox">winBox</a></li>
            
                <li class="parent " data-name="Window#x"><a href="Window.html#x">x</a></li>
            
                <li class="parent " data-name="Window#y"><a href="Window.html#y">y</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            <span class="subtitle">Typedefs</span>
            
                <li class="parent" data-name="Window~WindowOptions"><a href="Window.html#~WindowOptions">WindowOptions</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li class="parent  " data-name="Window#attachToScreen"><a href="Window.html#attachToScreen">attachToScreen</a></li>
            
                <li class="parent  " data-name="Window#blur"><a href="Window.html#blur">blur</a></li>
            
                <li class="parent  " data-name="Window#center"><a href="Window.html#center">center</a></li>
            
                <li class="parent  " data-name="Window#close"><a href="Window.html#close">close</a></li>
            
                <li class="parent  " data-name="Window#focus"><a href="Window.html#focus">focus</a></li>
            
                <li class="parent  " data-name="Window#isClosed"><a href="Window.html#isClosed">isClosed</a></li>
            
                <li class="parent  " data-name="Window#isModal"><a href="Window.html#isModal">isModal</a></li>
            
                <li class="parent  " data-name="Window#load"><a href="Window.html#load">load</a></li>
            
                <li class="parent  " data-name="Window#maximize"><a href="Window.html#maximize">maximize</a></li>
            
                <li class="parent  " data-name="Window#move"><a href="Window.html#move">move</a></li>
            
                <li class="parent  " data-name="Window#open"><a href="Window.html#open">open</a></li>
            
                <li class="parent  " data-name="Window#reposition"><a href="Window.html#reposition">reposition</a></li>
            
                <li class="parent  " data-name="Window#resize"><a href="Window.html#resize">resize</a></li>
            
                <li class="parent  " data-name="Window#save"><a href="Window.html#save">save</a></li>
            
                <li class="parent  " data-name="Window#sendToBack"><a href="Window.html#sendToBack">sendToBack</a></li>
            
                <li class="parent  " data-name="Window#sendToFront"><a href="Window.html#sendToFront">sendToFront</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li class="parent" data-name="Window#event:blur"><a href="Window.html#event:blur">blur</a></li>
            
                <li class="parent" data-name="Window#event:close"><a href="Window.html#event:close">close</a></li>
            
                <li class="parent" data-name="Window#event:focus"><a href="Window.html#event:focus">focus</a></li>
            
                <li class="parent" data-name="Window#event:maximize"><a href="Window.html#event:maximize">maximize</a></li>
            
                <li class="parent" data-name="Window#event:maximize-restore"><a href="Window.html#event:maximize-restore">maximize-restore</a></li>
            
                <li class="parent" data-name="Window#event:move"><a href="Window.html#event:move">move</a></li>
            
                <li class="parent" data-name="Window#event:move-end"><a href="Window.html#event:move-end">move-end</a></li>
            
                <li class="parent" data-name="Window#event:move-start"><a href="Window.html#event:move-start">move-start</a></li>
            
                <li class="parent" data-name="Window#event:move-x"><a href="Window.html#event:move-x">move-x</a></li>
            
                <li class="parent" data-name="Window#event:move-y"><a href="Window.html#event:move-y">move-y</a></li>
            
                <li class="parent" data-name="Window#event:open"><a href="Window.html#event:open">open</a></li>
            
                <li class="parent" data-name="Window#event:resize"><a href="Window.html#event:resize">resize</a></li>
            
                <li class="parent" data-name="Window#event:resize-end"><a href="Window.html#event:resize-end">resize-end</a></li>
            
                <li class="parent" data-name="Window#event:resize-height"><a href="Window.html#event:resize-height">resize-height</a></li>
            
                <li class="parent" data-name="Window#event:resize-start"><a href="Window.html#event:resize-start">resize-start</a></li>
            
                <li class="parent" data-name="Window#event:resize-width"><a href="Window.html#event:resize-width">resize-width</a></li>
            
            </ul>
        </li>
    
        
        <li class="item" data-name="WindowManager">
            <span class="title  ">
                
                <a href="WindowManager.html">WindowManager</a>
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li class="parent " data-name="WindowManager#bounds"><a href="WindowManager.html#bounds">bounds</a></li>
            
                <li class="parent " data-name="WindowManager#wallpaper"><a href="WindowManager.html#wallpaper">wallpaper</a></li>
            
                <li class="parent " data-name="WindowManager#win"><a href="WindowManager.html#win">win</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            <span class="subtitle">Typedefs</span>
            
                <li class="parent" data-name="WindowManager~Bounds"><a href="WindowManager.html#~Bounds">Bounds</a></li>
            
                <li class="parent" data-name="WindowManager~SnapOptions"><a href="WindowManager.html#~SnapOptions">SnapOptions</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li class="parent  " data-name="WindowManager#closeAll"><a href="WindowManager.html#closeAll">closeAll</a></li>
            
                <li class="parent  " data-name="WindowManager#createWindow"><a href="WindowManager.html#createWindow">createWindow</a></li>
            
                <li class="parent  " data-name="WindowManager#getWindowById"><a href="WindowManager.html#getWindowById">getWindowById</a></li>
            
                <li class="parent  " data-name="WindowManager#load"><a href="WindowManager.html#load">load</a></li>
            
                <li class="parent  " data-name="WindowManager#save"><a href="WindowManager.html#save">save</a></li>
            
                <li class="parent  " data-name="WindowManager#sendToBack"><a href="WindowManager.html#sendToBack">sendToBack</a></li>
            
                <li class="parent  " data-name="WindowManager#sendToFront"><a href="WindowManager.html#sendToFront">sendToFront</a></li>
            
                <li class="parent  " data-name="WindowManager#snap"><a href="WindowManager.html#snap">snap</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        
        <h1 class="page-title" data-filename="src_Snap.js.html">Source: src/Snap.js</h1>
        
        


    
    <section>
        <header>
            <div class="header content-size">
                <h2>src/Snap.js</h2>
            </div>
        </header>
        <article>
            <pre id="source-code" class="prettyprint source "><code>import { html } from './html'
import { Menu } from './Menu/Menu'

const DEFAULT_COLOR = '#a8f0f4'
const DEFAULT_SIZE = 10

const SnapOptionsDefault = {
    screen: true,
    windows: true,
    snap: 20,
    color: DEFAULT_COLOR,
    spacing: 0,
    indicator: DEFAULT_SIZE
}

/**
 * edge snapping plugin
 * @param {WindowManager} wm
 * @param {object} [options]
 * @param {boolean} [options.screen=true] snap to screen edges
 * @param {boolean} [options.windows=true] snap to window edges
 * @param {number} [options.snap=20] distance to edge in pixels before snapping and width/height of snap bars
 * @param {string} [options.color=#a8f0f4] color for snap bars
 * @param {number} [options.spacing=0] spacing distance between window and edges
 * @param {number} [options.indicator=10] size in pixels of snapping indicator (the indicator is actually twice the size of what is shown)
 * @ignore
 */
export class Snap
{
    constructor(wm, options={})
    {
        this.wm = wm
        this.options = { ...SnapOptionsDefault, ...options }
        this.highlights = html({ parent: this.wm.wallpaper, styles: { position: 'absolute' } })
        this.horizontal = html({
            parent: this.highlights, styles: {
                display: 'none',
                position: 'absolute',
                height: `${this.options.indicator}px`,
                borderRadius: `${this.options.indicator}px`,
                backgroundColor: this.options.color
            }
        })
        this.vertical = html({
            parent: this.highlights, styles: {
                display: 'none',
                position: 'absolute',
                width: `${this.options.indicator}px`,
                borderRadius: `${this.options.indicator}px`,
                backgroundColor: this.options.color
            }
        })
        this.horizontal
        this.showing = []
    }

    stop()
    {
        this.highlights.remove()
        this.stopped = true
    }

    addWindow(win)
    {
        win.on('move', () => this.move(win))
        win.on('move-end', () => this.moveEnd(win))
    }

    screenMove(rect, horizontal, vertical)
    {
        const top = Menu.getApplicationHeight()
        const width = this.wm.win.clientWidth
        const height = this.wm.win.clientHeight
        if (rect.left - this.options.snap &lt;= width &amp;&amp; rect.right + this.options.snap >= 0)
        {
            if (Math.abs(rect.top - top) &lt;= this.options.snap)
            {
                horizontal.push({ distance: Math.abs(rect.top - top), left: 0, width, top: top, side: 'top', screen: true })
            }
            else if (Math.abs(rect.bottom - height) &lt;= this.options.snap)
            {
                horizontal.push({ distance: Math.abs(rect.bottom - height), left: 0, width, top: height, side: 'bottom', screen: true })
            }
        }
        if (rect.top - this.options.snap &lt;= height &amp;&amp; rect.bottom + this.options.snap >= 0)
        {
            if (Math.abs(rect.left - 0) &lt;= this.options.snap)
            {
                vertical.push({ distance: Math.abs(rect.left - 0), top: 0, height, left: 0, side: 'left', screen: true })
            }
            else if (Math.abs(rect.right - width) &lt;= this.options.snap)
            {
                vertical.push({ distance: Math.abs(rect.right - width), top: 0, height, left: width, side: 'right', screen: true })
            }
        }
    }

    windowsMove(original, rect, horizontal, vertical)
    {
        for (let win of this.wm.windows)
        {
            if (!win.options.noSnap &amp;&amp; win !== original)
            {
                const rect2 = win.win.getBoundingClientRect()
                if (rect.left - this.options.snap &lt;= rect2.right &amp;&amp; rect.right + this.options.snap >= rect2.left)
                {
                    if (Math.abs(rect.top - rect2.bottom) &lt;= this.options.snap)
                    {
                        horizontal.push({ distance: Math.abs(rect.top - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'top' })
                        if (Math.abs(rect.left - rect2.left) &lt;= this.options.snap)
                        {
                            vertical.push({ distance: Math.abs(rect.left - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'left', noSpacing: true })
                        }
                        else if (Math.abs(rect.right - rect2.right) &lt;= this.options.snap)
                        {
                            vertical.push({ distance: Math.abs(rect.right - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'right', noSpacing: true })
                        }
                    }
                    else if (Math.abs(rect.bottom - rect2.top) &lt;= this.options.snap)
                    {
                        horizontal.push({ distance: Math.abs(rect.bottom - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'bottom' })
                        if (Math.abs(rect.left - rect2.left) &lt;= this.options.snap)
                        {
                            vertical.push({ distance: Math.abs(rect.left - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'left', noSpacing: true })
                        }
                        else if (Math.abs(rect.right - rect2.right) &lt;= this.options.snap)
                        {
                            vertical.push({ distance: Math.abs(rect.right - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'right', noSpacing: true })
                        }
                    }
                }
                if (rect.top - this.options.snap &lt;= rect2.bottom &amp;&amp; rect.bottom + this.options.snap >= rect2.top)
                {
                    if (Math.abs(rect.left - rect2.right) &lt;= this.options.snap)
                    {
                        vertical.push({ distance: Math.abs(rect.left - rect2.right), top: rect2.top, height: rect2.height, left: rect2.right, side: 'left' })
                        if (Math.abs(rect.top - rect2.top) &lt;= this.options.snap)
                        {
                            horizontal.push({ distance: Math.abs(rect.top - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'top', noSpacing: true })
                        }
                        else if (Math.abs(rect.bottom - rect2.bottom) &lt;= this.options.snap)
                        {
                            horizontal.push({ distance: Math.abs(rect.bottom - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'bottom', noSpacing: true })
                        }
                    }
                    else if (Math.abs(rect.right - rect2.left) &lt;= this.options.snap)
                    {
                        vertical.push({ distance: Math.abs(rect.right - rect2.left), top: rect2.top, height: rect2.height, left: rect2.left, side: 'right' })
                        if (Math.abs(rect.top - rect2.top) &lt;= this.options.snap)
                        {
                            horizontal.push({ distance: Math.abs(rect.top - rect2.top), left: rect2.left, width: rect2.width, top: rect2.top, side: 'top', noSpacing: true })
                        }
                        else if (Math.abs(rect.bottom - rect2.bottom) &lt;= this.options.snap)
                        {
                            horizontal.push({ distance: Math.abs(rect.bottom - rect2.bottom), left: rect2.left, width: rect2.width, top: rect2.bottom, side: 'bottom', noSpacing: true })
                        }
                    }
                }
            }
        }
    }

    move(win)
    {
        if (this.stopped || win.options.noSnap || win.isModal())
        {
            return
        }
        this.horizontal.style.display = 'none'
        this.vertical.style.display = 'none'
        const horizontal = []
        const vertical = []
        const rect = win.win.getBoundingClientRect()
        if (this.options.screen)
        {
            this.screenMove(rect, horizontal, vertical)
        }
        if (this.options.windows)
        {
            this.windowsMove(win, rect, horizontal, vertical)
        }
        if (horizontal.length)
        {
            horizontal.sort((a, b) => { return a.distance - b.distance })
            const find = horizontal[0]
            this.horizontal.style.display = 'block'
            this.horizontal.style.width = find.width + 'px'
            this.horizontal.y = find.top - this.options.indicator / 2
            this.horizontal.yPosition = find.top
            this.horizontal.style.transform = `translate(${find.left}px,${this.horizontal.y}px)`
            this.horizontal.side = find.side
            this.horizontal.noSpacing = find.noSpacing
            this.horizontal.screen = find.screen
        }
        if (vertical.length)
        {
            vertical.sort((a, b) => { return a.distance - b.distance })
            const find = vertical[0]
            this.vertical.style.display  = 'block'
            this.vertical.style.height = find.height + 'px'
            this.vertical.x = find.left - this.options.indicator / 2
            this.vertical.xPosition = find.left
            this.vertical.style.transform = `translate(${this.vertical.x}px,${find.top}px)`
            this.vertical.side = find.side
            this.vertical.noSpacing = find.noSpacing
            this.vertical.screen = find.screen
        }
    }

    moveEnd(win)
    {
        if (this.stopped)
        {
            return
        }
        const bounds = this.wm.bounds
        const top = Menu.getApplicationHeight()
        if (this.horizontal.style.display === 'block')
        {
            const spacing = this.horizontal.noSpacing ? 0 : this.options.spacing
            switch (this.horizontal.side)
            {
                case 'top':
                    win.y = this.horizontal.yPosition + spacing - bounds.top + top
                    break

                case 'bottom':
                    win.bottom = Math.floor(this.horizontal.yPosition - spacing - bounds.top + top)
                    break
            }
            win.attachToScreen('vertical', this.horizontal.screen ? this.horizontal.side : '')
        }
        if (this.vertical.style.display === 'block')
        {
            const spacing = this.vertical.noSpacing ? 0 : this.options.spacing
            switch (this.vertical.side)
            {
                case 'left':
                    win.x = this.vertical.xPosition + spacing - bounds.left
                    break

                case 'right':
                    win.right = Math.floor(this.vertical.xPosition - spacing - bounds.left)
                    break
            }
            win.attachToScreen('horziontal', this.vertical.screen ? this.vertical.side : '')
        }
        this.horizontal.style.display = this.vertical.style.display = 'none'
    }
}


/**
 * @typedef {Object} Snap~SnapOptions
 * @property {boolean} [screen=true] snap to screen edges
 * @property {boolean} [windows=true] snap to window edges
 * @property {number} [snap=20] distance to edge before snapping
 * @property {string} [color=#a8f0f4] color for snap bars
 * @property {number} [spacing=0] spacing distance between window and edges
 * @property {number} [options.indicator=10] size in pixels of snapping indicator (the indicator is actually twice the size of what is shown)
 */</code></pre>
        </article>
    </section>






        

        <footer class="content-size">
            <div class="footer">
                Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.5</a> on Tue Jul 28 2020 11:30:49 GMT+0800 (Taipei Standard Time)
            </div>
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/main.js"></script>
</body>
</html>
